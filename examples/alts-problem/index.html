<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta name="generator" content="Hugo 0.50" />
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title> Alt&#39;s problem </title>

  
  <meta name="description" content="A classical problem from robotics"> 
  
  
  
  
  

  

  <meta name="author" content="Paul Breiding, Anna Eckhardt and Sascha Timme">


  <meta property="og:title" content="Alt&#39;s problem" />
<meta property="og:description" content="A classical problem from robotics" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/examples/alts-problem/" /><meta property="article:published_time" content="2019-10-28T21:56:55&#43;01:00"/>
<meta property="article:modified_time" content="2019-10-28T21:56:55&#43;01:00"/>

  




  
  
  
  
  

  <link rel="canonical" href="/examples/alts-problem/">  

  

  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">

  <link href="/css/font.css" rel="stylesheet" type="text/css">
  <link href="/css/kube.min.css" rel="stylesheet" type="text/css">
  <link href="/css/kube.legenda.css" rel="stylesheet" type="text/css">
  <link href="/css/highlight.css" rel="stylesheet" type="text/css">
  <link href="/css/master.css" rel="stylesheet" type="text/css">
  <link href="/css/kube.demo.css" rel="stylesheet" type="text/css">


  <script src="/js/jquery-2.1.4.min.js" type="text/javascript"> </script>
  <script src="/js/bootstrap.min.js" type="text/javascript"> </script>

  <script type="text/javascript" src="/js/tocbot.min.js"></script>


    
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130815722-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    console.log(document.location.hostname.search("juliahomotopycontinuation.org") )
    
    if (document.location.hostname.search("juliahomotopycontinuation.org") == -1) {
      window['ga-disable-UA-130815722-1'] = true;
    }

    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-130815722-1');
  </script>


  

    
    
    <link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/atom-one-light.min.css">
    <script src="/js/highlight.pack.js"></script>
    <script src="/js/init-highlight.js"></script>
 
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js" integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>

    
    <link href="/css/custom.css" rel="stylesheet" type="text/css">
    
</head>


<body class="page-kube">
  <header> <div class="show-sm">
    <div id="nav-toggle-box">
      <div id="nav-toggle-brand">
        <a href="/">HomotopyContinuation.jl</a>
      </div><a data-component="toggleme" data-target="#top" href="#" id="nav-toggle"><i class="kube-menu"></i></a>
    </div>
  </div>
  <div class="hide-sm" id="top">
    <div id="top-brand">
      <a href="/" title="home">HomotopyContinuation.jl</a>
    </div>
    <nav id="top-nav-main">
      <ul> 
       
       
    <li><a href="/guides/" >Guides</a></li>
    
    <li><a href="/examples/" >Examples</a></li>
    
    <li><a href="https://juliahomotopycontinuation.github.io/HomotopyContinuation.jl/stable/" >API Docs</a></li>
    
    <li><a href="/about/" >About</a></li>
    
    <li><a href="/faq/" >FAQ</a></li>
    
    <li><a href="/do-it-yourself" >Do It Yourself</a></li>
    
    <li><a href="https://www.github.com/JuliaHomotopyContinuation/HomotopyContinuation.jl" >Github</a></li>
    
      </ul>
    </nav>
    <nav id="top-nav-extra"> 
      <ul>
          
      </ul>
    </nav>
  </div>
 </header>
  <main>
<div class="push-center" itemscope itemtype="http://schema.org/API DocsPosting">
    
<meta itemprop="name" content="Alt&#39;s problem">
<meta itemprop="description" content="A classical problem from robotics">


<meta itemprop="datePublished" content="2019-10-28T21:56:55&#43;01:00" />
<meta itemprop="dateModified" content="2019-10-28T21:56:55&#43;01:00" />
<meta itemprop="wordCount" content="1643">



<meta itemprop="keywords" content="example," />

<div id="hero">
    <h1 itemprop="headline">  Alt&#39;s problem</h1>
    
<blockquote itemprop="description">A classical problem from robotics</blockquote>

<time class="post-time"><span class="icon">
  <i class="fa fa-clock-o" aria-hidden="true"></i>
</span>
<span>8 minute read</span>
<span class="icon">
 <i class="fa fa-pencil" aria-hidden="true"></i>
</span>

  Published: <time datetime="2019-10-28T21:56:55&#43;01:00">28 Oct, 2019</time>

</time>
</div>
<div id="post-box">
<div id="post" itemprop="articleBody">
    
    

<p><span style="color: gray">This post was worked out in a <a href="https://www.math.tu-berlin.de/fachgebiete_ag_diskalg/fachgebiet_algorithmische_algebra/v_menue/veranstaltungen/2019ss/software_seminar_numerical_nonlinear_algebra/">student seminar</a> that we held at TU Berlin in summer 2019. </span></p>

<p>A four bar linkage, also called four bar, is a mechanism of four bars connected in a loop by four joints. One bar is fixed to the ground and on top of the opposing bar sits a triangle called coupler triangle whose apex is called coupler point. In motion this coupler point follows a curve called coupler curve:</p>

<p style="text-align:center;"><img src="/videos/four-bar.mp4" width="400px"/></p>

<p>The synthesis problem describes the problem of finding all four bars whose coupler curve passes through a given number of precision points. The largest possible number of prescribed precision points is $9$. This problem was first formulated by Alt in 1923 and completely solved by <a href="https://asmedigitalcollection.asme.org/mechanicaldesign/article-abstract/114/1/153/429455/Complete-Solution-of-the-Nine-Point-Path-Synthesis">Wampler et al.</a>
in 1992 using homotopy continuation.</p>

<p>In case the reader just wants to create videos like the one above, we have created a <a href="https://github.com/JuliaHomotopyContinuation/FourBarLinkages.jl">shortcut</a>:</p>

<pre><code class="language-julia">using Pkg
pkg&quot;add https://github.com/JuliaHomotopyContinuation/FourBarLinkages.jl.git&quot;
using FourBarLinkages

# coupler points in isotropic coordinates
coupler_points = [
    complex(0.8961867,-0.09802917),
    complex(1.2156535, -1.18749100),
    complex(1.5151435, -0.85449808),
    complex(1.6754775,  -0.48768058),
    complex(1.7138690,-0.30099232),
    complex(1.7215236,0.03269953),
    complex(1.6642029, 0.33241088),
    complex(1.4984171, 0.74435576),
    complex(1.3011834,  0.92153806)
]

# compute four bar linkages for the couple points from the stored results
fourbars = four_bars(coupler_points)

# pick a fourbar
F = fourbars[3]
# animate
animate(F, coupler_points)
# create endless loop (interrupt to stop)
animate(F, coupler_points; loop=true)
# save animation and hide axis
animate(F, coupler_points; filename=&quot;four-bar.gif&quot;, show_axis=true)
</code></pre>

<p>In the rest of this example, based on Wampler et. al., we will show how we can implement an adapted algorithm in Julia using HomotopyContinuation.jl.</p>

<h2 id="constructing-the-polynomial-system">Constructing the polynomial system</h2>

<p>First up we will derive the polynomial system describing the problem.</p>

<p>Instead of looking at the bars as vectors in $\mathbb{R}^2$, we will look at them as vectors in the complex plane.</p>

<p>First we observe the relation of the triangles $ADP$ and $BPC$ from the next picture.</p>

<p style="text-align:center;"><img src="/images/plot.jpeg" width="300px"/></p>

<p>$A$ and $B$ are fixed hinges, $P$ denotes the coupler point. We have</p>

<p>$$ u = x-a \quad \text{and} \quad   v = y-b.$$</p>

<p>Let $\lambda$ and $\mu$ denote the rotation of bars $u$ and $v$ and $\theta$ denotes the rotation of the coupler triangle $CPD$, as shown in the next picture.</p>

<p style="text-align:center;"><img src="/images/plot2.jpg" width="300px"/></p>

<p>Here, $P_0$ and $P_1$ are two of the nine  precision points. The black dots depict the associated coupler curve.</p>

<p>We have the following equations for $\lambda, \theta, \mu$:</p>

<p>$$
u e^{i \lambda_j} =x e^{i \theta_j} + P_j-P_0-a  \quad \text{and}\quad
y e^{i \mu_j} = y e^{i \theta_j} + P_j-P_0-b .
$$</p>

<p>Setting $\delta_j = P_j-P_0$ for  $j=1,\ldots,8$ we have</p>

<p>$$
(x-a) e^{i \lambda_j} =x  e^{i \theta_j} + \delta_j -a  \quad \text{and}\quad
(y-b) e^{i \mu_j} = y e^{i \theta_j} + \delta_j -b
$$</p>

<p>We need to make further reductions to get a polynomial system.
Multiplying with the complex conjugates we have</p>

<p>$$
(x-a)  e^{i \lambda_j} ( \overline{x}-\overline{a} ) e^{-i \lambda_j} = (x e^{i \theta_j} + \delta_j -a ) (\overline{x} e^{-i \theta_j} + \overline{\delta}_j -\overline{a})
$$</p>

<p>which is equivalent to</p>

<p>$$
\begin{array}{ll}
&amp;x\overline{x} -x\overline{a}-a\overline{x} +a\overline{a} \\ &amp;=  x\overline{x} + x \overline{\delta}_j e^{i \theta_j} -x\overline{a}e^{i \theta_j} +\delta_j \overline{x} e^{-i \theta_j}  + \delta_j \overline{\delta}_j +\delta_j \overline{a} -a\overline{x} e^{-i \theta_j}-a\overline{\delta}_j +a\overline{a}
\end{array}
$$</p>

<p>A substitution of variables via $\gamma_i:= e^{i \theta_j}-1$ , finally gives us for $i\in \{1,\ldots ,8\}$</p>

<p>$$
(\overline a - \overline \delta_i)x\gamma_i+(a-\delta_i)\overline x \overline \gamma_i+(\overline a- \overline x)\delta_i+(a-x)\overline \delta_i-\delta_i\overline \delta_i  =0
$$</p>

<p>Additionally, the $\gamma_i$ satisfy the following equality</p>

<p>$$
\gamma_i \overline \gamma_i+\gamma_i + \overline \gamma_i=0
$$</p>

<p>With a the same argument we also get</p>

<p>$$
(\overline b-\overline \delta_i)y\gamma_i+(b-\delta_i)\overline y\overline \gamma_i+(\overline b-\overline y)\delta_i+(b-y)\overline \delta_i-\delta_i\overline \delta_i =0.
$$</p>

<p>The last three equations completely determine the coupler curve. However, they are not algebraic equations, because complex conjugation is not algebraic. To obtain a polynomial system we consider $x$ and $\bar{x}$ as <em>independent</em> variables (and similarly for all others). Afterwards, we filter out the solutions for which $x$ and $\bar{x}$ are not complex conjugates. We call the solutions where complex conjugation relations are satisfied <em>real solutions</em>  since they correspond to real vectors in the plane.</p>

<p>Substituting the $\delta_i$s with our given precision points results in a polynomial system of $24$ variables in $24$ equations.</p>

<h2 id="solving-the-nine-point-path-synthesis-problem">Solving the Nine Point Path Synthesis Problem</h2>

<p>Similar to Wampler et. al. we first calculate all four bars for a given set of precision points and the track solutions to a new set of precision points. In order to calculate the start solution, we use monodromy to speed up the calculation.</p>

<p>This is the basic idea of the algorithm.</p>

<ul>
<li><p>Take a random four bar and find $9$ random precision points on its coupler curve.</p></li>

<li><p>Given these $9$ precision points find all four bars whose coupler curve passes through them.</p></li>

<li><p>Given any $9$ new precision points find all fitting four bars tracking from the solution set of step $2$.</p></li>

<li><p>Filter all real solutions.</p></li>
</ul>

<p>Step $1$ and $2$ need only be calculated once and can be used repeatedly to solve new problems.</p>

<p>First we define the variables in <code>Julia</code>.</p>

<pre><code class="language-julia">using HomotopyContinuation

@polyvar x a y b x̄ ā ȳ b̄
@polyvar γ[1:8] γ̄[1:8]
@polyvar δ[1:8] δ̄[1:8]
</code></pre>

<p>Next we define the polynomial system as above.</p>

<pre><code class="language-julia">#system of polynomials
D1 = [(ā * x - δ̄[i] * x) * γ[i] + (a * x̄ - δ[i] * x̄) *  γ̄[i] +
      (ā - x̄) * δ[i] + (a - x) * δ̄[i] - δ[i] * δ̄[i] for i in 1:8]
D2 = [(b̄ * y - δ̄[i] * y) * γ[i] + (b * ȳ - δ[i] * ȳ) * γ̄[i] +
      (b̄ - ȳ) * δ[i] + (b - y) * δ̄[i] - δ[i] * δ̄[i] for i in 1:8]
D3 = [γ[i] * γ̄[i] + γ[i] + γ̄[i] for i in 1:8]

fourbar_system = [D1; D2; D3]
</code></pre>

<h2 id="step-1">Step 1</h2>

<p>For our first step it is not necessary to pick a four bar with physical meaning. We generate $x, \overline{x}, a , \overline{a},&hellip;$ as random complex numbers. For $\gamma_1, &hellip;,\gamma_8, \overline{\gamma}_1,&hellip; \overline{\gamma}_8$ we generate random angles $\theta_1$,&hellip;,$\theta_8$ and then compute $\gamma_i:= e^{i \theta_j}-1$ and the conjugates respectively. Next we substitute these variables and solve <code>D1 = D2 = 0</code> as equations in $\delta_1,\ldots,\delta_8$ and $\overline{\delta}_1,\ldots,\overline{\delta}_8$.
This can be done separately for each $i\in {1,\ldots,8}$ as the pair of equations <code>D1[i] = D2[i] = 0</code> only depends on $\delta_i$ and $\overline \delta_i$.</p>

<pre><code class="language-julia">args = 2π * im .* rand(8)
Γ = exp.(args) .- 1
Γ̄ = exp.(-args) .- 1
xayb = randn(ComplexF64,8)

δδ̄_results = map(D1, D2) do d1, d2
    d = [d1; d2]
    start_sys = [subs(f, [x; x̄; a; ā; y; ȳ; b; b̄] =&gt; xayb, γ =&gt; Γ, γ̄ =&gt; Γ̄) for f in d]
    # only keep first solution
    first(solutions(solve(start_sys)))
end
δ_start = first.(δδ̄_results)
δ̄_start = last.(δδ̄_results)
</code></pre>

<h2 id="step-2">Step 2</h2>

<p>In the next step we turn our problem around. Instead of looking for the precision points we act as if we picked these precision points and wanted to find all other four bars whose coupler curves move through these precision points. Wampler et. al. showed that there are $6 \cdot 1442 = 8652$ solutions for this polynomial system.</p>

<p>Since we already have one solution we can use <a href="guides/monodromy">monodromy</a> to find all other solutions.
In order to speed up the calculation we can exploit two group actions acting on the solution set.</p>

<h3 id="group-actions">Group Actions</h3>

<p>One group action appears when we relabel the bars. If we exchange $x$ and $y$, $a$ and $b$ etc. we also get a valid solution. This group action halves the number of solutions leaving us with 4326 solutions modulo this group action.</p>

<pre><code class="language-julia"># Switch roles of (x,a) and (y,b).
# We have the variable ordering x a y b x̂ â ŷ b̂
# so we need to switch to y b x a ŷ b̂ x̂ â
relabeling(s) = [[s[3],s[4],s[1],s[2],s[7],s[8],s[5],s[6]]; s[9:24]]
</code></pre>

<p>The next group action is due to Roberts. It states that given a four bar, we can find two related four bars (called Roberts cognates) that follow the same coupler curve:
$$
    r(x,a,y,b,\theta, \lambda, \mu) =
    \left(\frac{(x-a)y}{x-y}, \frac{bx-ay}{x-y},a-x,a, \lambda, \mu, \theta\right).
$$
These cognates are also solutions of our problem. This leaves us with $1442$ solutions modulo both group actions.</p>

<p>Since $\theta, \lambda, \mu$ aren&rsquo;t variables of our system, we make the following adjustment: substitute $x,a,y,b$ and $\theta=\gamma_i+1$ and define $\lambda$ and $\mu$ as follows</p>

<p>$$
\lambda_j = \frac{x \theta_j + \delta_j -a}{x-a }  \quad \text{and} \quad
\mu_j = \frac{y \theta_j + \delta_j -b}{y-b}.
$$</p>

<p>Since the Roberts&rsquo; cognates depend on $\delta_j$ and $\bar{\delta}_j$ we have to give the values of <code>Γ</code> and <code>Γ̄</code> to the implementation
in the <code>FourBarLinkages</code> package</p>

<pre><code class="language-julia">roberts_cognates(s) = FourBarLinkages.roberts_cognates(s, δ_start, δ̄_start)
</code></pre>

<h3 id="computing-all-solutions">Computing all solutions</h3>

<p>Here is the code for computing all solutions with monodromy.</p>

<pre><code class="language-julia">start_solution = [xayb; Γ; Γ̄]
start_params  = [δ_start; δ̄_start]

monodromy_result = monodromy_solve(fourbar_system, start_solution, start_params;
                                   parameters = [δ; δ̄],
                                   group_actions = [relabeling, roberts_cognates],
                                   target_solutions_count = 1442)

start_solutions = solutions(monodromy_result)
</code></pre>

<h2 id="step-3">Step 3</h2>

<p>For the third step we track from our set of start solutions to any solution given nine precision points.
Assume we are given the 9 <code>coupler_points</code> from the beginning. For them this looks as follows:</p>

<pre><code class="language-julia">δ = coupler_points[2:9] .- coupler_points[1]
δ̄ = conj.(δ)
final_result = solve(fourbar_system, start_solutions;
                     parameters = [δ; δ̄],
                     start_parameters = start_params,
                     target_parameters=[δ; δ̄])

results = solutions(final_result)
</code></pre>

<h2 id="step-4">Step 4</h2>

<p>Since we are only interested in solutions with physical meaning, we now filter for real solutions. This we can do by checking if $\mathrm{conj}(x) \approx \overline{x}$, $\mathrm{conj}(y) \approx \overline{y}$,&hellip;</p>

<pre><code class="language-julia">real_fourbars = filter(s -&gt; all(i -&gt; s[i] ≈ conj(s[i+4]), 1:4), solutions(final_result))
</code></pre>

<h3 id="results">Results</h3>

<p>Following Wampler et al. we try our method on the following examples:</p>

<ul>
<li><p>random example
<p style="text-align:center;"><img src="/images/random.png" width="300px"/></p></p></li>

<li><p>all points are positioned on an oval
<p style="text-align:center;"><img src="/images/oval.png" width="300px"/></p></p></li>

<li><p>3 points on one circle, 4 on another
<p style="text-align:center;"><img src="/images/twocircles.png" width="300px"/></p></p></li>

<li><p>5 points on a line, 4 on another
<p style="text-align:center;"><img src="/images/line.png" width="300px"/></p></p></li>
</ul>

<p>In the pictures one can see that the coupler curve is not necessarily connected.</p>

<strong>Cite this example:</strong>
<pre style="background: transparent;">
<code class="language-julia hljs">@Misc{ alts-problem2019 ,
    author =  { Paul Breiding, Anna Eckhardt and Sascha Timme },
    title = { Alt&#39;s problem },
    howpublished = { \url{ https://www.JuliaHomotopyContinuation.org/examples/alts-problem/ } },
    note = { Accessed: November 5, 2019 }
}</code>
</pre>



</div>

<div class="">
    <p>
  Published
  
    
      by <span itemprop="author">Paul Breiding, Anna Eckhardt and Sascha Timme</span>
    
  
  <time datetime="2019-10-28T21:56:55&#43;01:00">
    28 Oct, 2019
  </time>
  
</p>

    
</div>


    
</div>
</div>
</main>
  <footer>   <footer id="footer">
    <nav>
      <ul>
        <li><span>HomotopyContinuation.jl</span></li>
        <li>
          <a href="/about/">About</a>
        </li>
        <li>
            <a href="/examples/">Examples</a>
          </li>
        <li>
          <a href="/guides/">Guides</a>
        </li>
      </ul>
    </nav>
    
  </footer> </footer>


  <script src="/js/kube.js" type="text/javascript">
  </script>
  <script src="/js/kube.legenda.js" type="text/javascript">
  </script>
  <script src="/js/master.js" type="text/javascript">
  </script>
  <script type="text/javascript">
     document.addEventListener("DOMContentLoaded", function() {
           renderMathInElement(document.body, {delimiters: [
          {left: "$$", right: "$$", display: true},
          {left: "$", right: "$", display: false},
          {left: "``", right: "``", display: false},
          
          
          
        ]});
      });</script>
</body>

</html>
