<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta name="generator" content="Hugo 0.60.0" />
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title> Computer vision </title>

  
  <meta name="description" content="Triangulation of a dinosaur"> 
  
  
  
  
  

  

  <meta name="author" content="Paul Breiding, Christoph Schmidt">


  <meta property="og:title" content="Computer vision" />
<meta property="og:description" content="Triangulation of a dinosaur" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/examples/computer-vision/" />
<meta property="article:published_time" content="2019-09-03T21:56:55+01:00" />
<meta property="article:modified_time" content="2019-09-03T21:56:55+01:00" />

  




  
  
  
  
  

  <link rel="canonical" href="/examples/computer-vision/">  

  

  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">

  <link href="/css/font.css" rel="stylesheet" type="text/css">
  <link href="/css/kube.min.css" rel="stylesheet" type="text/css">
  <link href="/css/kube.legenda.css" rel="stylesheet" type="text/css">
  <link href="/css/highlight.css" rel="stylesheet" type="text/css">
  <link href="/css/master.css" rel="stylesheet" type="text/css">
  <link href="/css/kube.demo.css" rel="stylesheet" type="text/css">


  <script src="/js/jquery-2.1.4.min.js" type="text/javascript"> </script>
  <script src="/js/bootstrap.min.js" type="text/javascript"> </script>

  <script type="text/javascript" src="/js/tocbot.min.js"></script>


    
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130815722-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    console.log(document.location.hostname.search("juliahomotopycontinuation.org") )
    
    if (document.location.hostname.search("juliahomotopycontinuation.org") == -1) {
      window['ga-disable-UA-130815722-1'] = true;
    }

    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-130815722-1');
  </script>


  

    
    
    <link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/atom-one-light.min.css">
    <script src="/js/highlight.pack.js"></script>
    <script src="/js/init-highlight.js"></script>
 
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css" integrity="sha384-t5CR+zwDAROtph0PXGte6ia8heboACF9R5l/DiY+WZ3P2lxNgvJkQk5n7GPvLMYw" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" integrity="sha384-FaFLTlohFghEIZkw6VGwmf9ISTubWAVYW8tG8+w2LAIftJEULZABrF9PPFv+tVkH" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/contrib/auto-render.min.js" integrity="sha384-bHBqxz8fokvgoJ/sc17HODNxa42TlaEhB+w8ZJXTc2nZf1VgEaFZeZvT4Mznfz0v" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>
    
    <link href="/css/custom.css" rel="stylesheet" type="text/css">
    
</head>


<body class="page-kube">
  <header> <div>
<div class="show-sm">
    <div id="nav-toggle-box">
      <div id="nav-toggle-brand">
        <a href="/">HomotopyContinuation.jl</a>
      </div><a data-component="toggleme" data-target="#top" href="#" id="nav-toggle"><i class="kube-menu"></i></a>
    </div>
  
  </div>
  <div class="hide-sm" id="top">
    <div id="top-brand">
      <a href="/" title="home">HomotopyContinuation.jl</a>
    </div>
    <nav id="top-nav-main">
      <ul> 
       
       
    <li><a href="/guides/" >Guides</a></li>
    
    <li><a href="/examples/" >Examples</a></li>
    
    <li><a href="https://juliahomotopycontinuation.github.io/HomotopyContinuation.jl/stable/" >Docs</a></li>
    
    <li><a href="/about/" >About</a></li>
    
    <li><a href="/faq/" >FAQ</a></li>
    
    <li><a href="/do-it-yourself" >Do It Yourself</a></li>
    
    <li><a href="/changelog/" >Changelog</a></li>
    
    <li><a href="https://www.github.com/JuliaHomotopyContinuation/HomotopyContinuation.jl" >Github</a></li>
    
      </ul>
    </nav>
    <nav id="top-nav-extra"> 
      <ul>
          
      </ul>
    </nav>
  </div>
  
</div> </header>
  <main>
<div class="push-center" itemscope itemtype="http://schema.org/API DocsPosting">
    <meta itemprop="name" content="Computer vision">
<meta itemprop="description" content="Triangulation of a dinosaur">
<meta itemprop="datePublished" content="2019-09-03T21:56:55&#43;01:00" />
<meta itemprop="dateModified" content="2019-09-03T21:56:55&#43;01:00" />
<meta itemprop="wordCount" content="981">



<meta itemprop="keywords" content="example," />
<div id="hero">
    <h1 itemprop="headline">  Computer vision</h1>
    
<blockquote itemprop="description">Triangulation of a dinosaur</blockquote>

<time class="post-time"><span class="icon">
  <i class="fa fa-clock-o" aria-hidden="true"></i>
</span>
<span>5 minute read</span>
<span class="icon">
 <i class="fa fa-pencil" aria-hidden="true"></i>
</span>

  Published: <time datetime="2019-09-03T21:56:55&#43;01:00">3 Sep, 2019</time>

</time>
</div>
<div id="post-box">
<div id="post" itemprop="articleBody">
    
    <p><span style="color: gray">This post was worked out in a <a href="https://www.math.tu-berlin.de/fachgebiete_ag_diskalg/fachgebiet_algorithmische_algebra/v_menue/veranstaltungen/2019ss/software_seminar_numerical_nonlinear_algebra/">student seminar</a> that we held at TU Berlin in summer 2019. </span></p>
<p>We want to reconstruct a three-dimensional object from two-dimensional images. Think of an object, maybe a <a href="https://www.robots.ox.ac.uk/~vgg/data/data-mview.html">dinosaur</a>, that is captured by $n$ cameras from different angles. Suppose we have the following information available:</p>
<ul>
<li>the configuration of the cameras (in the form of <a href="https://en.wikipedia.org/wiki/Pinhole_camera_model">camera</a> <a href="https://en.wikipedia.org/wiki/Camera_matrix">matrices</a>);</li>
<li>sets of 2D points in the $n$ two-dimensional images, where each set corresponds to one 3D point.</li>
</ul>
<p>(Actually, the second bullet is the more challenging part in reconstructing three-dimensional objects. We assume that this task has already been done.)</p>
<p>The goal is to compute the following 3D picture</p>
<p style="text-align:center;"><img src="/images/dino.png" width="700px"/></p>
<p>In theory, it suffices to have two matching 2D points and the configuration of the cameras to <em>exactly</em> reconstruct the corresponding 3D point. In practice, there is lens distortion, pixelation, the algorithm matching the 2D points is not working fully precise and so on. This is why we are looking for 3D points that minimize the euclidean distance regarding their 2D image points. We want to solve an optimization problem.</p>
<p>This post is restricted to the case $n=2$, i.e. we want to reconstruct 3D points from images captured by two cameras at a time. We take the <a href="https://www.robots.ox.ac.uk/~vgg/data/data-mview.html">dinosaur</a> data set from the Visual Geometry Group
Department of Engineering Science at the University of Oxford. This contains a list of <a href="https://gist.github.com/PBrdng/46436855f3755c5a959a7c5d6ba7e32b#file-cameras-jl">36 cameras</a> as $3\times 4$ matrices and a corresponding list of <a href="https://gist.github.com/PBrdng/46436855f3755c5a959a7c5d6ba7e32b#file-pictures-jl">pictures taken from 4983 world points</a>. (For using the code below one must download the files from these links.)</p>
<p>Let $x\in\mathbb{R}^3$ be a 3D point. Then, taking a picture $u=(u_1,u_2)\in\mathbb{R}^2$ of $x$ is modeled as</p>
<p>$$ \begin{pmatrix} u_1 \\ u_2 \\ 1 \end{pmatrix} = t  A  \begin{pmatrix}x_1 \\ x_2 \\ x_3  \\ 1\end{pmatrix},$$</p>
<p>where $A\in \mathbb{R}^{3\times 4}$ is the camera matrix and $t \in \mathbb{R}, t \neq 0$, is a scalar. This is called the pinhole camera model. Let us write $y(x)$ for the first two entries of  $A \begin{pmatrix} x\\ 1\end{pmatrix}$, and $z(x)$ for the third entry. Then, $u=t y(x)$ and $1 = t z(x)$.</p>
<p>If $p = (p_1, p_2) \in\mathbb{R}^2\times \mathbb{R}^2$ are two input pictures from the data set, we want to solve the following minimization problem:</p>
<p>$$
\underset{(x,t) \in \mathbb{R}^3\times (\mathbb{R}\backslash \{0\})^2}{\operatorname{argmin}} \lVert t_1  y_1(x) - p_1 \rVert^2 + \lVert  t_2   y_2(x) - p_2 \rVert^2
$$</p>
<p>$$
\text{s.t. } t_1  z_1(x) = 1 \text{ and } t_2  z_2(x)=1.\quad $$</p>
<h2 id="implementation-with-homotopy-continuation">Implementation with Homotopy Continuation</h2>
<p>Now let's solve this optimization problem using homotopy continuation by solving the critical equations. We use the cameras <code>n₁=1</code> and <code>n₂=2</code>. The camera data</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia"><span style="color:#66d9ef">using</span> HomotopyContinuation<span style="color:#f92672"></span>, LinearAlgebra<span style="color:#f92672"></span>

<span style="color:#75715e"># download camera and pictures data and load it</span>
include<span style="color:#f92672"></span>(download<span style="color:#f92672"></span>(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">h</span><span style="color:#e6db74">t</span><span style="color:#e6db74">t</span><span style="color:#e6db74">p</span><span style="color:#e6db74">s</span><span style="color:#e6db74">:</span><span style="color:#e6db74">/</span><span style="color:#e6db74">/</span><span style="color:#e6db74">g</span><span style="color:#e6db74">i</span><span style="color:#e6db74">s</span><span style="color:#e6db74">t</span><span style="color:#e6db74">.</span><span style="color:#e6db74">g</span><span style="color:#e6db74">i</span><span style="color:#e6db74">t</span><span style="color:#e6db74">h</span><span style="color:#e6db74">u</span><span style="color:#e6db74">b</span><span style="color:#e6db74">u</span><span style="color:#e6db74">s</span><span style="color:#e6db74">e</span><span style="color:#e6db74">r</span><span style="color:#e6db74">c</span><span style="color:#e6db74">o</span><span style="color:#e6db74">n</span><span style="color:#e6db74">t</span><span style="color:#e6db74">e</span><span style="color:#e6db74">n</span><span style="color:#e6db74">t</span><span style="color:#e6db74">.</span><span style="color:#e6db74">c</span><span style="color:#e6db74">o</span><span style="color:#e6db74">m</span><span style="color:#e6db74">/</span><span style="color:#e6db74">P</span><span style="color:#e6db74">B</span><span style="color:#e6db74">r</span><span style="color:#e6db74">d</span><span style="color:#e6db74">n</span><span style="color:#e6db74">g</span><span style="color:#e6db74">/</span><span style="color:#e6db74">4</span><span style="color:#e6db74">6</span><span style="color:#e6db74">4</span><span style="color:#e6db74">3</span><span style="color:#e6db74">6</span><span style="color:#e6db74">8</span><span style="color:#e6db74">5</span><span style="color:#e6db74">5</span><span style="color:#e6db74">f</span><span style="color:#e6db74">3</span><span style="color:#e6db74">7</span><span style="color:#e6db74">5</span><span style="color:#e6db74">5</span><span style="color:#e6db74">c</span><span style="color:#e6db74">5</span><span style="color:#e6db74">a</span><span style="color:#e6db74">9</span><span style="color:#e6db74">5</span><span style="color:#e6db74">9</span><span style="color:#e6db74">a</span><span style="color:#e6db74">7</span><span style="color:#e6db74">c</span><span style="color:#e6db74">5</span><span style="color:#e6db74">d</span><span style="color:#e6db74">6</span><span style="color:#e6db74">b</span><span style="color:#e6db74">a</span><span style="color:#e6db74">7</span><span style="color:#e6db74">e</span><span style="color:#e6db74">3</span><span style="color:#e6db74">2</span><span style="color:#e6db74">b</span><span style="color:#e6db74">/</span><span style="color:#e6db74">r</span><span style="color:#e6db74">a</span><span style="color:#e6db74">w</span><span style="color:#e6db74">/</span><span style="color:#e6db74">5</span><span style="color:#e6db74">e</span><span style="color:#e6db74">6</span><span style="color:#e6db74">b</span><span style="color:#e6db74">e</span><span style="color:#e6db74">8</span><span style="color:#e6db74">f</span><span style="color:#e6db74">4</span><span style="color:#e6db74">c</span><span style="color:#e6db74">9</span><span style="color:#e6db74">6</span><span style="color:#e6db74">7</span><span style="color:#e6db74">3</span><span style="color:#e6db74">f</span><span style="color:#e6db74">0</span><span style="color:#e6db74">d</span><span style="color:#e6db74">d</span><span style="color:#e6db74">2</span><span style="color:#e6db74">6</span><span style="color:#e6db74">0</span><span style="color:#e6db74">1</span><span style="color:#e6db74">0</span><span style="color:#e6db74">b</span><span style="color:#e6db74">5</span><span style="color:#e6db74">e</span><span style="color:#e6db74">0</span><span style="color:#e6db74">c</span><span style="color:#e6db74">e</span><span style="color:#e6db74">f</span><span style="color:#e6db74">c</span><span style="color:#e6db74">8</span><span style="color:#e6db74">e</span><span style="color:#e6db74">9</span><span style="color:#e6db74">5</span><span style="color:#e6db74">3</span><span style="color:#e6db74">f</span><span style="color:#e6db74">c</span><span style="color:#e6db74">1</span><span style="color:#e6db74">c</span><span style="color:#e6db74">0</span><span style="color:#e6db74">/</span><span style="color:#e6db74">c</span><span style="color:#e6db74">a</span><span style="color:#e6db74">m</span><span style="color:#e6db74">e</span><span style="color:#e6db74">r</span><span style="color:#e6db74">a</span><span style="color:#e6db74">s</span><span style="color:#e6db74">.</span><span style="color:#e6db74">j</span><span style="color:#e6db74">l</span><span style="color:#e6db74">&#34;</span>))
include<span style="color:#f92672"></span>(download<span style="color:#f92672"></span>(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">h</span><span style="color:#e6db74">t</span><span style="color:#e6db74">t</span><span style="color:#e6db74">p</span><span style="color:#e6db74">s</span><span style="color:#e6db74">:</span><span style="color:#e6db74">/</span><span style="color:#e6db74">/</span><span style="color:#e6db74">g</span><span style="color:#e6db74">i</span><span style="color:#e6db74">s</span><span style="color:#e6db74">t</span><span style="color:#e6db74">.</span><span style="color:#e6db74">g</span><span style="color:#e6db74">i</span><span style="color:#e6db74">t</span><span style="color:#e6db74">h</span><span style="color:#e6db74">u</span><span style="color:#e6db74">b</span><span style="color:#e6db74">u</span><span style="color:#e6db74">s</span><span style="color:#e6db74">e</span><span style="color:#e6db74">r</span><span style="color:#e6db74">c</span><span style="color:#e6db74">o</span><span style="color:#e6db74">n</span><span style="color:#e6db74">t</span><span style="color:#e6db74">e</span><span style="color:#e6db74">n</span><span style="color:#e6db74">t</span><span style="color:#e6db74">.</span><span style="color:#e6db74">c</span><span style="color:#e6db74">o</span><span style="color:#e6db74">m</span><span style="color:#e6db74">/</span><span style="color:#e6db74">P</span><span style="color:#e6db74">B</span><span style="color:#e6db74">r</span><span style="color:#e6db74">d</span><span style="color:#e6db74">n</span><span style="color:#e6db74">g</span><span style="color:#e6db74">/</span><span style="color:#e6db74">4</span><span style="color:#e6db74">6</span><span style="color:#e6db74">4</span><span style="color:#e6db74">3</span><span style="color:#e6db74">6</span><span style="color:#e6db74">8</span><span style="color:#e6db74">5</span><span style="color:#e6db74">5</span><span style="color:#e6db74">f</span><span style="color:#e6db74">3</span><span style="color:#e6db74">7</span><span style="color:#e6db74">5</span><span style="color:#e6db74">5</span><span style="color:#e6db74">c</span><span style="color:#e6db74">5</span><span style="color:#e6db74">a</span><span style="color:#e6db74">9</span><span style="color:#e6db74">5</span><span style="color:#e6db74">9</span><span style="color:#e6db74">a</span><span style="color:#e6db74">7</span><span style="color:#e6db74">c</span><span style="color:#e6db74">5</span><span style="color:#e6db74">d</span><span style="color:#e6db74">6</span><span style="color:#e6db74">b</span><span style="color:#e6db74">a</span><span style="color:#e6db74">7</span><span style="color:#e6db74">e</span><span style="color:#e6db74">3</span><span style="color:#e6db74">2</span><span style="color:#e6db74">b</span><span style="color:#e6db74">/</span><span style="color:#e6db74">r</span><span style="color:#e6db74">a</span><span style="color:#e6db74">w</span><span style="color:#e6db74">/</span><span style="color:#e6db74">5</span><span style="color:#e6db74">e</span><span style="color:#e6db74">6</span><span style="color:#e6db74">b</span><span style="color:#e6db74">e</span><span style="color:#e6db74">8</span><span style="color:#e6db74">f</span><span style="color:#e6db74">4</span><span style="color:#e6db74">c</span><span style="color:#e6db74">9</span><span style="color:#e6db74">6</span><span style="color:#e6db74">7</span><span style="color:#e6db74">3</span><span style="color:#e6db74">f</span><span style="color:#e6db74">0</span><span style="color:#e6db74">d</span><span style="color:#e6db74">d</span><span style="color:#e6db74">2</span><span style="color:#e6db74">6</span><span style="color:#e6db74">0</span><span style="color:#e6db74">1</span><span style="color:#e6db74">0</span><span style="color:#e6db74">b</span><span style="color:#e6db74">5</span><span style="color:#e6db74">e</span><span style="color:#e6db74">0</span><span style="color:#e6db74">c</span><span style="color:#e6db74">e</span><span style="color:#e6db74">f</span><span style="color:#e6db74">c</span><span style="color:#e6db74">8</span><span style="color:#e6db74">e</span><span style="color:#e6db74">9</span><span style="color:#e6db74">5</span><span style="color:#e6db74">3</span><span style="color:#e6db74">f</span><span style="color:#e6db74">c</span><span style="color:#e6db74">1</span><span style="color:#e6db74">c</span><span style="color:#e6db74">0</span><span style="color:#e6db74">/</span><span style="color:#e6db74">p</span><span style="color:#e6db74">i</span><span style="color:#e6db74">c</span><span style="color:#e6db74">t</span><span style="color:#e6db74">u</span><span style="color:#e6db74">r</span><span style="color:#e6db74">e</span><span style="color:#e6db74">s</span><span style="color:#e6db74">.</span><span style="color:#e6db74">j</span><span style="color:#e6db74">l</span><span style="color:#e6db74">&#34;</span>))
n₁<span style="color:#f92672"></span>, n₂<span style="color:#f92672"></span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>
camera_numbers<span style="color:#f92672"></span> <span style="color:#f92672">=</span> [n₁<span style="color:#f92672"></span>, n₂<span style="color:#f92672"></span>]

<span style="color:#a6e22e">@var</span><span style="color:#f92672"></span> x<span style="color:#f92672"></span>[<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>]
<span style="color:#a6e22e">@var</span><span style="color:#f92672"></span> t<span style="color:#f92672"></span>[<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>]
<span style="color:#a6e22e">@var</span><span style="color:#f92672"></span> p<span style="color:#f92672"></span>[<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>]

y<span style="color:#f92672"></span> <span style="color:#f92672">=</span> [cams<span style="color:#f92672"></span>[i<span style="color:#f92672"></span>][<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>,<span style="color:#f92672">:</span>]<span style="color:#f92672">*</span>[x<span style="color:#f92672"></span>; <span style="color:#ae81ff">1</span>] <span style="color:#66d9ef">for</span> i<span style="color:#f92672"></span> <span style="color:#66d9ef">in</span> camera_numbers<span style="color:#f92672"></span>]
z<span style="color:#f92672"></span> <span style="color:#f92672">=</span> [cams<span style="color:#f92672"></span>[i<span style="color:#f92672"></span>][<span style="color:#ae81ff">3</span>,<span style="color:#f92672">:</span>] <span style="color:#f92672">⋅</span> [x<span style="color:#f92672"></span>; <span style="color:#ae81ff">1</span>] <span style="color:#66d9ef">for</span> i<span style="color:#f92672"></span> <span style="color:#66d9ef">in</span> camera_numbers<span style="color:#f92672"></span>] <span style="color:#f92672">.*</span> <span style="color:#ae81ff">648</span>
</code></pre></div><p>The last multiplication by 648 is because the data is given in pixel units (between 0 and 648). For numerical stability it is better to work with coordinates between 0 and 1. Now, we define the target function.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia">g<span style="color:#f92672"></span> <span style="color:#f92672">=</span> [t<span style="color:#f92672"></span>[i<span style="color:#f92672"></span>] <span style="color:#f92672">.*</span> y<span style="color:#f92672"></span>[i<span style="color:#f92672"></span>] <span style="color:#f92672">-</span> p<span style="color:#f92672"></span>[<span style="color:#f92672">:</span>,i<span style="color:#f92672"></span>] <span style="color:#66d9ef">for</span> i<span style="color:#f92672"></span> <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>]
G<span style="color:#f92672"></span> <span style="color:#f92672">=</span> sum<span style="color:#f92672"></span>(gᵢ<span style="color:#f92672"></span> <span style="color:#f92672">⋅</span> gᵢ<span style="color:#f92672"></span> <span style="color:#66d9ef">for</span> gᵢ<span style="color:#f92672"></span> <span style="color:#66d9ef">in</span> g<span style="color:#f92672"></span>)
<span style="color:#75715e"># G is the function that we want to optimize</span>
</code></pre></div><p>For <code>G</code> we generate the critical equations <code>F=0</code> using Lagrange multipliers.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia"><span style="color:#a6e22e">@var</span><span style="color:#f92672"></span> λ<span style="color:#f92672"></span>[<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>] <span style="color:#75715e"># the Lagrance multipliers</span>
L<span style="color:#f92672"></span> <span style="color:#f92672">=</span> G<span style="color:#f92672"></span> <span style="color:#f92672">-</span> sum<span style="color:#f92672"></span>(λ<span style="color:#f92672"></span>[i<span style="color:#f92672"></span>] <span style="color:#f92672">*</span> (t<span style="color:#f92672"></span>[i<span style="color:#f92672"></span>] <span style="color:#f92672">*</span> z<span style="color:#f92672"></span>[i<span style="color:#f92672"></span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#66d9ef">for</span> i<span style="color:#f92672"></span> <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>)
∇L<span style="color:#f92672"></span> <span style="color:#f92672">=</span> differentiate<span style="color:#f92672"></span>(L<span style="color:#f92672"></span>, [x<span style="color:#f92672"></span>;t<span style="color:#f92672"></span>;λ<span style="color:#f92672"></span>])
F<span style="color:#f92672"></span> <span style="color:#f92672">=</span> System<span style="color:#f92672"></span>(∇L<span style="color:#f92672"></span>; variables<span style="color:#f92672"></span> <span style="color:#f92672">=</span> [x<span style="color:#f92672"></span>;t<span style="color:#f92672"></span>;λ<span style="color:#f92672"></span>], parameters<span style="color:#f92672"></span> <span style="color:#f92672">=</span> vec<span style="color:#f92672"></span>(p<span style="color:#f92672"></span>))
</code></pre></div><p><code>F</code> is a system of polynomials in the variables <code>x</code>, <code>t</code> and <code>λ</code> and the parameters <code>p</code>. We want to solve this system many times for different parameters. For this, we use the guide on how to <a href="guides/many-systems">track many systems in a loop</a>.</p>
<p>First, we need an initial solution for a random set of parameters.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia">p₀<span style="color:#f92672"></span> <span style="color:#f92672">=</span> randn<span style="color:#f92672"></span>(ComplexF64<span style="color:#f92672"></span>, <span style="color:#ae81ff">4</span>)
start<span style="color:#f92672"></span> <span style="color:#f92672">=</span> solutions<span style="color:#f92672"></span>(solve<span style="color:#f92672"></span>(F<span style="color:#f92672"></span>; target_parameters<span style="color:#f92672"></span> <span style="color:#f92672">=</span> p₀<span style="color:#f92672"></span>))
</code></pre></div><p><code>start</code> contains 6 solutions. At the end of this example we discuss that the number of critical points <code>F=0</code> is indeed 6. Now, we track these 6 solutions towards the photo parameters we are interested in.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia"><span style="color:#75715e">#first, we need to preprocess the photo data</span>
photos<span style="color:#f92672"></span> <span style="color:#f92672">=</span> [ps<span style="color:#f92672"></span>[i<span style="color:#f92672"></span>, [<span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> n₁<span style="color:#f92672"></span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> n₁<span style="color:#f92672"></span>, <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> n₂<span style="color:#f92672"></span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> n₂<span style="color:#f92672"></span>]] <span style="color:#66d9ef">for</span> i<span style="color:#f92672"></span> <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">4983</span>]

<span style="color:#75715e"># the data from the dataset is incomplete.</span>
<span style="color:#75715e"># the cameras did not take pictures of all world points.</span>
<span style="color:#75715e"># if a world point was not captured, the entry in the data set is -1.</span>
filter!<span style="color:#f92672"></span>(pᵢ<span style="color:#f92672"></span> <span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span> all<span style="color:#f92672"></span>(pᵢ<span style="color:#f92672"></span> <span style="color:#f92672">.&gt;</span> <span style="color:#ae81ff">0</span>), photos<span style="color:#f92672"></span>)

<span style="color:#75715e"># we divide the photo coordinates by 648</span>
<span style="color:#75715e"># to work with coordinates between 0 and 1</span>
<span style="color:#75715e"># (as explained above)</span>
map!<span style="color:#f92672"></span>(pᵢ<span style="color:#f92672"></span> <span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span> pᵢ<span style="color:#f92672"></span><span style="color:#f92672">./</span><span style="color:#ae81ff">648</span>, photos<span style="color:#f92672"></span>, photos<span style="color:#f92672"></span>)

<span style="color:#66d9ef">function</span> reconstruction_from_critical_points<span style="color:#f92672"></span>(R<span style="color:#f92672"></span>, pᵢ<span style="color:#f92672"></span>, G<span style="color:#f92672"></span>)
	r<span style="color:#f92672"></span> <span style="color:#f92672">=</span> real_solutions<span style="color:#f92672"></span>(R<span style="color:#f92672"></span>)
	N<span style="color:#f92672"></span> <span style="color:#f92672">=</span> map<span style="color:#f92672"></span>(r<span style="color:#f92672"></span>) <span style="color:#66d9ef">do</span> rᵢ<span style="color:#f92672"></span>
		G<span style="color:#f92672"></span>([x<span style="color:#f92672"></span>;t<span style="color:#f92672"></span>] <span style="color:#f92672">=</span><span style="color:#f92672">&gt;</span> rᵢ<span style="color:#f92672"></span>[<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">5</span>], vec<span style="color:#f92672"></span>(p<span style="color:#f92672"></span>) <span style="color:#f92672">=</span><span style="color:#f92672">&gt;</span> pᵢ<span style="color:#f92672"></span>)
	<span style="color:#66d9ef">end</span>
	i<span style="color:#f92672"></span> <span style="color:#f92672">=</span> findmin<span style="color:#f92672"></span>(N<span style="color:#f92672"></span>)

	<span style="color:#66d9ef">return</span> r<span style="color:#f92672"></span>[i<span style="color:#f92672"></span>[<span style="color:#ae81ff">2</span>]][<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>]
<span style="color:#66d9ef">end</span>


reconstructed_points<span style="color:#f92672"></span> <span style="color:#f92672">=</span> solve<span style="color:#f92672"></span>(
    F<span style="color:#f92672"></span>,
    start<span style="color:#f92672"></span>;
    start_parameters<span style="color:#f92672"></span> <span style="color:#f92672">=</span>  p₀<span style="color:#f92672"></span>,
    target_parameters<span style="color:#f92672"></span> <span style="color:#f92672">=</span> photos<span style="color:#f92672"></span>,
    transform_result<span style="color:#f92672"></span> <span style="color:#f92672">=</span> (R<span style="color:#f92672"></span>,pᵢ<span style="color:#f92672"></span>) <span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span> reconstruction_from_critical_points<span style="color:#f92672"></span>(R<span style="color:#f92672"></span>,pᵢ<span style="color:#f92672"></span>,G<span style="color:#f92672"></span>)
)
</code></pre></div><p>Doing this for several pairs of cameras we get the above picture.</p>
<h2 id="eddegree-of-the-multiview-variety">EDdegree of the Multiview variety</h2>
<p>The closure (under <a href="https://en.wikipedia.org/wiki/Zariski_topology">Zariski topology</a>) of</p>
<p>$$\{(t_1y_1(x), t_2y_2(x))\in \mathbb{R}^2\times \mathbb{R}^2   \mid  t_1z_1(x) = t_2z_2(x) = 1,  (x,t)\in \mathbb{R}^3 \times (\mathbb{R}\backslash \{0\})^2\}$$</p>
<p>is called <em>(affine) multiview variety</em> for two cameras.</p>
<p>Regarding such an affine multiview variety, the number of (complex) critical points of the squared distance function <code>G</code> is an invariant, which is called the <em>euclidean distance degree</em> (ED degree). <a href="https://arxiv.org/abs/1812.05648">Maxim, Rodriguez and Wang proved</a> showed that the EDdegree of the Multiview variety for 2 cameras is 6. We used this information in the code above for verifying that the initial computation for <code>F₀</code> was correct.</p>
<strong>Cite this example:</strong>
<pre style="background: transparent;">
<code class="language-julia hljs">@Misc{ computer-vision2023 ,
    author =  { Paul Breiding, Christoph Schmidt },
    title = { Computer vision },
    howpublished = { \url{ https://www.JuliaHomotopyContinuation.org/examples/computer-vision/ } },
    note = { Accessed: March 10, 2023 }
}</code>
</pre>



</div>

<div class="">
    <p>
  Published
  
    
      by <span itemprop="author">Paul Breiding, Christoph Schmidt</span>
    
  
  <time datetime="2019-09-03T21:56:55&#43;01:00">
    3 Sep, 2019
  </time>
  
</p>

    
</div>


    
</div>
</div>
</main>
  <footer>   <footer id="footer">
    <nav>
      <ul>
        <li><span>HomotopyContinuation.jl</span></li>
        <li>
          <a href="/about/">About</a>
        </li>
        <li>
            <a href="/examples/">Examples</a>
          </li>
        <li>
          <a href="/guides/">Guides</a>
        </li>
      </ul>
    </nav>
    
  </footer> </footer>


  <script src="/js/kube.js" type="text/javascript">
  </script>
  <script src="/js/kube.legenda.js" type="text/javascript">
  </script>
  <script src="/js/master.js" type="text/javascript">
  </script>
  <script type="text/javascript">
     document.addEventListener("DOMContentLoaded", function() {
           renderMathInElement(document.body, {delimiters: [
          {left: "$$", right: "$$", display: true},
          {left: "$", right: "$", display: false},
          {left: "``", right: "``", display: false},
          
          
          
        ]});
      });</script>
</body>

</html>
