<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta name="generator" content="Hugo 0.60.0" />
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title> Low rank tensor recovery </title>

  
  <meta name="description" content="Reconstructing a tensor from linear measurements"> 
  
  
  
  
  

  

  <meta name="author" content="Paul Breiding, Fulvio Gesmundo, Mateusz Michalek, and Nick Vannieuwenhoven">


  <meta property="og:title" content="Low rank tensor recovery" />
<meta property="og:description" content="Reconstructing a tensor from linear measurements" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/examples/tensor-recovery/" />
<meta property="article:published_time" content="2021-05-31T21:56:55+01:00" />
<meta property="article:modified_time" content="2021-05-31T21:56:55+01:00" />

  




  
  
  
  
  

  <link rel="canonical" href="/examples/tensor-recovery/">  

  

  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">

  <link href="/css/font.css" rel="stylesheet" type="text/css">
  <link href="/css/kube.min.css" rel="stylesheet" type="text/css">
  <link href="/css/kube.legenda.css" rel="stylesheet" type="text/css">
  <link href="/css/highlight.css" rel="stylesheet" type="text/css">
  <link href="/css/master.css" rel="stylesheet" type="text/css">
  <link href="/css/kube.demo.css" rel="stylesheet" type="text/css">


  <script src="/js/jquery-2.1.4.min.js" type="text/javascript"> </script>
  <script src="/js/bootstrap.min.js" type="text/javascript"> </script>

  <script type="text/javascript" src="/js/tocbot.min.js"></script>


    
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130815722-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    console.log(document.location.hostname.search("juliahomotopycontinuation.org") )
    
    if (document.location.hostname.search("juliahomotopycontinuation.org") == -1) {
      window['ga-disable-UA-130815722-1'] = true;
    }

    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-130815722-1');
  </script>


  

    
    
    <link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/atom-one-light.min.css">
    <script src="/js/highlight.pack.js"></script>
    <script src="/js/init-highlight.js"></script>
 
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css" integrity="sha384-t5CR+zwDAROtph0PXGte6ia8heboACF9R5l/DiY+WZ3P2lxNgvJkQk5n7GPvLMYw" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" integrity="sha384-FaFLTlohFghEIZkw6VGwmf9ISTubWAVYW8tG8+w2LAIftJEULZABrF9PPFv+tVkH" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/contrib/auto-render.min.js" integrity="sha384-bHBqxz8fokvgoJ/sc17HODNxa42TlaEhB+w8ZJXTc2nZf1VgEaFZeZvT4Mznfz0v" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>
    
    <link href="/css/custom.css" rel="stylesheet" type="text/css">
    
</head>


<body class="page-kube">
  <header> <div>
<div class="show-sm">
    <div id="nav-toggle-box">
      <div id="nav-toggle-brand">
        <a href="/">HomotopyContinuation.jl</a>
      </div><a data-component="toggleme" data-target="#top" href="#" id="nav-toggle"><i class="kube-menu"></i></a>
    </div>
  
  </div>
  <div class="hide-sm" id="top">
    <div id="top-brand">
      <a href="/" title="home">HomotopyContinuation.jl</a>
    </div>
    <nav id="top-nav-main">
      <ul> 
       
       
    <li><a href="/guides/" >Guides</a></li>
    
    <li><a href="/examples/" >Examples</a></li>
    
    <li><a href="https://juliahomotopycontinuation.github.io/HomotopyContinuation.jl/stable/" >Docs</a></li>
    
    <li><a href="/about/" >About</a></li>
    
    <li><a href="/faq/" >FAQ</a></li>
    
    <li><a href="/changelog/" >Changelog</a></li>
    
    <li><a href="https://www.github.com/JuliaHomotopyContinuation/HomotopyContinuation.jl" >Github</a></li>
    
      </ul>
    </nav>
    <nav id="top-nav-extra"> 
      <ul>
          
      </ul>
    </nav>
  </div>
  
</div> </header>
  <main>
<div class="push-center" itemscope itemtype="http://schema.org/API DocsPosting">
    <meta itemprop="name" content="Low rank tensor recovery">
<meta itemprop="description" content="Reconstructing a tensor from linear measurements">
<meta itemprop="datePublished" content="2021-05-31T21:56:55&#43;01:00" />
<meta itemprop="dateModified" content="2021-05-31T21:56:55&#43;01:00" />
<meta itemprop="wordCount" content="969">



<meta itemprop="keywords" content="example," />
<div id="hero">
    <h1 itemprop="headline">  Low rank tensor recovery</h1>
    
<blockquote itemprop="description">Reconstructing a tensor from linear measurements</blockquote>

<time class="post-time"><span class="icon">
  <i class="fa fa-clock-o" aria-hidden="true"></i>
</span>
<span>5 minute read</span>
<span class="icon">
 <i class="fa fa-pencil" aria-hidden="true"></i>
</span>

  Published: <time datetime="2021-05-31T21:56:55&#43;01:00">31 May, 2021</time>

</time>
</div>
<div id="post-box">
<div id="post" itemprop="articleBody">
    
    <p>Consider the problem of reconstructing a tensor $T\in\mathbb R^{n_1\times \cdots \times n_d}$ from linear measurements $\mu_1(T), \ldots, \mu_s(T)$, where each $\mu_i: \mathbb R^{n_1\times \cdots \times n_d}\to \mathbb R$ is a linear function.</p>
<p>This problem is called <em>tensor recovery</em>. If the $\mu_i$ are coordinate projections this is also known as <em>tensor completion</em>.</p>
<p>For a fixed measurement $y\in\mathbb R^s$, there are infinitely many tensors $T\in\mathbb R^{n_1\times \cdots \times n_d}$ with</p>
<p>$$\mu(T) = (\mu_1(T), \ldots, \mu_s(T)) = y.$$</p>
<p>Therefore, in order to have the tensor recovery well-posed we need some additional assumption. One common assumption is that the tensor $T$ has low rank. If $s$ is equal to the dimension of rank-$r$ tensors in $\mathbb R^{n_1\times \cdots \times n_d}$, then for a general measurement $\mu$ almost all tensors $T$ can be recovered: $\mu^{-1}(\mu(T))$ is finite. We will confirm this experimentally.</p>
<p>In this example we will recover a $4\times 3\times 2$ tensor of rank $2$ from the following incomplete tensor displayed by two $4\times 3$ slices:</p>
<p>$$ T = \begin{bmatrix} -32   &amp; ?     &amp; -24\\ 72    &amp; ?     &amp; ?  \\ -104  &amp; 40    &amp; ? \\ ?     &amp; 16    &amp; 0\end{bmatrix}\quad \begin{bmatrix}?   &amp; 10    &amp; ? \\ -57   &amp; 27    &amp; ?\\ -11   &amp; 1     &amp; ?\\ -1    &amp; ?     &amp; -7\end{bmatrix}.$$</p>
<p>The symbol ? means that this coordinate is not observed. In <code>julia</code> we use the symbol <code>:?</code> for denoting unobserved entries.</p>
<pre><code class="language-julia-repl" data-lang="julia-repl">julia&gt; T = reshape([
        -32 :? -24 :? 10 :?;
        72 :? :? -57 27 :?;
        -104 40 :? -11 1 :?;
        :? 16 0 -1 :? -7], 4,3,2)
4×3×2 Array{Any, 3}:
[:, :, 1] =
  -32      :?  -24
   72      :?     :?
 -104    40       :?
     :?  16      0

[:, :, 2] =
    :?  10      :?
 -57    27      :?
 -11     1      :?
  -1      :?  -7
</code></pre><p>The number of observed entries is 14. This equals he dimension $d$ of rank-$2$ tensors in $\mathbb R^{4\times 3\times 2}$, so recovery is possible, in principle. Let us define the input data for the recovery problem and denote it by $y$:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia">observed_entries<span style="color:#f92672"></span> <span style="color:#f92672">=</span> findall<span style="color:#f92672"></span>(vec<span style="color:#f92672"></span>(T<span style="color:#f92672"></span>) <span style="color:#f92672">.!=</span> <span style="color:#f92672">:</span><span style="color:#f92672">?</span>)
y<span style="color:#f92672"></span> <span style="color:#f92672">=</span> vec<span style="color:#f92672"></span>(T<span style="color:#f92672"></span>)[observed_entries<span style="color:#f92672"></span>]
y<span style="color:#f92672"></span> <span style="color:#f92672">=</span> convert<span style="color:#f92672"></span>(<span style="color:#66d9ef">Vector</span>{<span style="color:#66d9ef">Float64</span>}, y<span style="color:#f92672"></span>)
</code></pre></div><p>Now, $y$ is a vector that contains the observed coordinates of $T$.</p>
<p>We define the coordinate projection $\mu$ that projects onto the observed coordinates of $T$:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia"><span style="color:#66d9ef">using</span> LinearAlgebra<span style="color:#f92672"></span>
n<span style="color:#f92672"></span> <span style="color:#f92672">=</span> [<span style="color:#ae81ff">4</span>; <span style="color:#ae81ff">3</span>; <span style="color:#ae81ff">2</span>]
Id<span style="color:#f92672"></span> <span style="color:#f92672">=</span> diagm<span style="color:#f92672"></span>(<span style="color:#ae81ff">0</span> <span style="color:#f92672">=</span><span style="color:#f92672">&gt;</span> ones<span style="color:#f92672"></span>(prod<span style="color:#f92672"></span>(n<span style="color:#f92672"></span>)))
μ<span style="color:#f92672"></span> <span style="color:#f92672">=</span> Id<span style="color:#f92672"></span>[observed_entries<span style="color:#f92672"></span>, <span style="color:#f92672">:</span>]
</code></pre></div><h2 id="setting-up-a-polynomial-system">Setting up a polynomial system</h2>
<p>To recover $T$ from $\mu(T)$ we define a polynomial system. First, we parametrize rank-2 tensors as follows:
$$\mathbb T = a_1 \otimes b_1 \otimes c_1 + a_2 \otimes b_2 \otimes c_2,$$
where $a_i,b_i,c_i\in \mathbb R^3$ for $i=1,2$.</p>
<p>Here, $\mathbb T$ should be understood as a function in $a_1,a_2,b_1,b_2,c_1,c_2$.</p>
<p>To get a one-to-one parametrization we set the last entries of $a_1,a_2,b_1,b_2$ equal to $1$ (this parametrizes a Euclidean dense subset of all rank-$2$ tensors).</p>
<p>Let us implement this in Julia.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia"><span style="color:#66d9ef">using</span> HomotopyContinuation<span style="color:#f92672"></span>

<span style="color:#75715e">## 𝕋 = 4x3x2 tensor of rank r=2</span>
r<span style="color:#f92672"></span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
<span style="color:#a6e22e">@var</span><span style="color:#f92672"></span> a<span style="color:#f92672"></span>[<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>r<span style="color:#f92672"></span>, <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>(n<span style="color:#f92672"></span>[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)] b<span style="color:#f92672"></span>[<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>r<span style="color:#f92672"></span>, <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>(n<span style="color:#f92672"></span>[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)] c<span style="color:#f92672"></span>[<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>r<span style="color:#f92672"></span>, <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>n<span style="color:#f92672"></span>[<span style="color:#ae81ff">3</span>]]
𝕋<span style="color:#f92672"></span> <span style="color:#f92672">=</span> sum<span style="color:#f92672"></span>( kron<span style="color:#f92672"></span>(c<span style="color:#f92672"></span>[i<span style="color:#f92672"></span>,<span style="color:#f92672">:</span>], [b<span style="color:#f92672"></span>[i<span style="color:#f92672"></span>,<span style="color:#f92672">:</span>];<span style="color:#ae81ff">1</span>], [a<span style="color:#f92672"></span>[i<span style="color:#f92672"></span>,<span style="color:#f92672">:</span>];<span style="color:#ae81ff">1</span>]) <span style="color:#66d9ef">for</span> i<span style="color:#f92672"></span> <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>r<span style="color:#f92672"></span>)
</code></pre></div><p>Now, we can set up a system of polynomials equations for recovery:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia">F<span style="color:#f92672"></span> <span style="color:#f92672">=</span> System<span style="color:#f92672"></span>(μ<span style="color:#f92672"></span> <span style="color:#f92672">*</span> 𝕋<span style="color:#f92672"></span> <span style="color:#f92672">-</span> y<span style="color:#f92672"></span>, variables<span style="color:#f92672"></span> <span style="color:#f92672">=</span> vec<span style="color:#f92672"></span>([a<span style="color:#f92672"></span> b<span style="color:#f92672"></span> c<span style="color:#f92672"></span>]))
</code></pre></div><p>which we solve directly:</p>
<pre><code class="language-julia-repl" data-lang="julia-repl">julia&gt; S_F = solve(F)
Result with 6 solutions
=======================
• 23 paths tracked
• 6 non-singular solutions (4 real)
• random_seed: 0x40c65a1d
• start_system: :polyhedral
</code></pre><p>We see that we there are 4 real solutions. They come in pairs of two corresponding to the $\mathbb Z/2\mathbb Z$ action which interchanges the summands in the definition of $T$.</p>
<p>We can check that we get 2 distinct solutions:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia">recovered_tensors<span style="color:#f92672"></span> <span style="color:#f92672">=</span> [evaluate<span style="color:#f92672"></span>(𝕋<span style="color:#f92672"></span>, vec<span style="color:#f92672"></span>([a<span style="color:#f92672"></span> b<span style="color:#f92672"></span> c<span style="color:#f92672"></span>]) <span style="color:#f92672">=</span><span style="color:#f92672">&gt;</span> sol<span style="color:#f92672"></span>) <span style="color:#66d9ef">for</span> sol<span style="color:#f92672"></span> <span style="color:#66d9ef">in</span> real_solutions<span style="color:#f92672"></span>(S_F<span style="color:#f92672"></span>)]
recovered_tensors<span style="color:#f92672"></span> <span style="color:#f92672">=</span> unique_points<span style="color:#f92672"></span>(recovered_tensors<span style="color:#f92672"></span>)
</code></pre></div><p>The number of recovered tensors is</p>
<pre><code class="language-julia-repl" data-lang="julia-repl">julia&gt; length(recovered_tensors)
2
</code></pre><p>Let us take a look at the recovered tensors:</p>
<pre><code class="language-julia-repl" data-lang="julia-repl">julia&gt; T₁ = reshape(recovered_tensors[1], 4, 3, 2)
4×3×2 Array{Float64, 3}:
[:, :, 1] =
  -32.0       411.518   -24.0
   72.0      1112.91   1075.77
 -104.0        40.0    -728.216
   -1.11448    16.0       0.0

[:, :, 2] =
 -26.0  10.0       -182.054
 -57.0  27.0       -396.574
 -11.0   1.0        -78.642
  -1.0   0.388769    -7.0
</code></pre><p>The other solutions is</p>
<pre><code class="language-julia-repl" data-lang="julia-repl">julia&gt; T₂ = reshape(recovered_tensors[2], 4, 3, 2)
4×3×2 Array{Float64, 3}:
[:, :, 1] =
-32.0    8.0  -24.0
 72.0  -40.0  -56.0
-104.0   40.0   -8.0
-40.0   16.0    0.0

[:, :, 2] =
-26.0  10.0   -2.0
-57.0  27.0   21.0
-11.0   1.0  -17.0
-1.0  -1.0   -7.0
</code></pre><p>It is interesting to observe that both tensors coincide, up to $14$ significant digits, in the unobserved coordinate $(1,1,2)$ with value $-26$. This implies that augmenting $\mu$ with a projection to this coordinate (so it projects to $s = d+1$ coordinates) will not eliminate either completed tensor, even though this number of measurements generically suffices for generic identifiability!</p>
<h2 id="condition-numbers">Condition numbers</h2>
<p>Let us compute the condition numbers of the recovered tensors. It is defined as</p>
<p>$$\kappa(T) = \frac{1}{\sigma_{\min}(MQ)},$$</p>
<p>where $M$ is the matrix defining $\mu$ and $Q$ is a matrix whose columns form an orthonormal basis for the tangent space of rank-2 tensors at $T$.</p>
<p>We compute $Q$ by using a QR-decomposition of the Jacobian matrix of <code>𝕋</code> at the computed solutions.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia">d<span style="color:#f92672"></span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">14</span>
J<span style="color:#f92672"></span> <span style="color:#f92672">=</span> differentiate<span style="color:#f92672"></span>(𝕋<span style="color:#f92672"></span>, vec<span style="color:#f92672"></span>([a<span style="color:#f92672"></span> b<span style="color:#f92672"></span> c<span style="color:#f92672"></span>]))
Js<span style="color:#f92672"></span> <span style="color:#f92672">=</span> [evaluate<span style="color:#f92672"></span>(J<span style="color:#f92672"></span>, vec<span style="color:#f92672"></span>([a<span style="color:#f92672"></span> b<span style="color:#f92672"></span> c<span style="color:#f92672"></span>]) <span style="color:#f92672">=</span><span style="color:#f92672">&gt;</span> sol<span style="color:#f92672"></span>) <span style="color:#66d9ef">for</span> sol<span style="color:#f92672"></span> <span style="color:#66d9ef">in</span> real_solutions<span style="color:#f92672"></span>(S_F<span style="color:#f92672"></span>)]
Qs<span style="color:#f92672"></span> <span style="color:#f92672">=</span> [(qr<span style="color:#f92672"></span>(J<span style="color:#f92672"></span>)<span style="color:#f92672">.</span>Q<span style="color:#f92672"></span>)[<span style="color:#f92672">:</span>, <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>d<span style="color:#f92672"></span>] <span style="color:#66d9ef">for</span> J<span style="color:#f92672"></span> <span style="color:#66d9ef">in</span> Js<span style="color:#f92672"></span>]
</code></pre></div><p>We compute the condition numbers for our computed solutions:</p>
<pre><code class="language-julia-repl" data-lang="julia-repl">julia&gt; [1/svdvals(μ * Q)[end] for Q in Qs]
4-element Vector{Float64}:
 1907.954236908041
   11.641768946763904
 1907.9542369079288
   11.641768946763932
</code></pre><p>The fact that each number appears twice is again due to the $\mathbb Z/2\mathbb Z$ action on the solutions.</p>
<p>Hence, <code>T₁</code> has a condition number of about 1907 and <code>T₂</code> a condition number of about 11.
<strong>Cite this example:</strong>
<pre style="background: transparent;">
<code class="language-julia hljs">@Misc{ tensor-recovery2025 ,
    author =  { Paul Breiding, Fulvio Gesmundo, Mateusz Michalek, and Nick Vannieuwenhoven },
    title = { Low rank tensor recovery },
    howpublished = { \url{ https://www.JuliaHomotopyContinuation.org/examples/tensor-recovery/ } },
    note = { Accessed: February 28, 2025 }
}</code>
</pre>
</p>


</div>

<div class="">
    <p>
  Published
  
    
      by <span itemprop="author">Paul Breiding, Fulvio Gesmundo, Mateusz Michalek, and Nick Vannieuwenhoven</span>
    
  
  <time datetime="2021-05-31T21:56:55&#43;01:00">
    31 May, 2021
  </time>
  
</p>

    
</div>


    
</div>
</div>
</main>
  <footer>   <footer id="footer">
    <nav>
      <ul>
        <li><span>HomotopyContinuation.jl</span></li>
        <li>
          <a href="/about/">About</a>
        </li>
        <li>
            <a href="/examples/">Examples</a>
          </li>
        <li>
          <a href="/guides/">Guides</a>
        </li>
      </ul>
    </nav>
    
  </footer> </footer>


  <script src="/js/kube.js" type="text/javascript">
  </script>
  <script src="/js/kube.legenda.js" type="text/javascript">
  </script>
  <script src="/js/master.js" type="text/javascript">
  </script>
  <script type="text/javascript">
     document.addEventListener("DOMContentLoaded", function() {
           renderMathInElement(document.body, {delimiters: [
          {left: "$$", right: "$$", display: true},
          {left: "$", right: "$", display: false},
          {left: "``", right: "``", display: false},
          
          
          
        ]});
      });</script>
</body>

</html>
