<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta name="generator" content="Hugo 0.50" />
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title> Parameter Homotopies </title>

  
  <meta name="description" content="How to track parametrized systems of equations."> 
  
  
  
  
  

  

  <meta name="author" content="">


  <meta property="og:title" content="Parameter Homotopies" />
<meta property="og:description" content="How to track parametrized systems of equations." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/guides/parameter-homotopies/" />

  




  
  
  
  
  

  <link rel="canonical" href="/guides/parameter-homotopies/">  

  

  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">

  <link href="/css/font.css" rel="stylesheet" type="text/css">
  <link href="/css/kube.min.css" rel="stylesheet" type="text/css">
  <link href="/css/kube.legenda.css" rel="stylesheet" type="text/css">
  <link href="/css/highlight.css" rel="stylesheet" type="text/css">
  <link href="/css/master.css" rel="stylesheet" type="text/css">
  <link href="/css/kube.demo.css" rel="stylesheet" type="text/css">


  <script src="/js/jquery-2.1.4.min.js" type="text/javascript"> </script>

  <script type="text/javascript" src="/js/tocbot.min.js"></script>


    
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130815722-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-130815722-1');
  </script>

  

    
    <link rel="stylesheet" href="/css/atom-one-dark.css">
    <script src="/js/highlight.pack.js"></script>
    <script src="/js/init-highlight.js"></script>

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/auto-render.min.js" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe" crossorigin="anonymous"></script>

    
    <link href="/css/custom.css" rel="stylesheet" type="text/css">
</head>


<body class="page-kube">
  <header> <div class="show-sm">
    <div id="nav-toggle-box">
      <div id="nav-toggle-brand">
        <a href="/">HomotopyContinuation.jl</a>
      </div><a data-component="toggleme" data-target="#top" href="#" id="nav-toggle"><i class="kube-menu"></i></a>
    </div>
  </div>
  <div class="hide-sm" id="top">
    <div id="top-brand">
      <a href="/" title="home">HomotopyContinuation.jl</a>
    </div>
    <nav id="top-nav-main">
      <ul> 
       
       
    <li><a href="https://juliahomotopycontinuation.github.io/HomotopyContinuation.jl/stable/" >API Docs</a></li>
    
    <li><a href="/blog/" >Blog</a></li>
    
    <li><a href="/faq/" >FAQ</a></li>
    
    <li><a href="/guides/" >Guides</a></li>
    
      </ul>
    </nav>
    <nav id="top-nav-extra"> 
      <ul>
          
      </ul>
    </nav>
  </div>
 </header>
  <main>
  <div id="main">
    <div id="hero">
      <h1> Parameter Homotopies </h1>
      <p class="hero-lead">
           We show how to track solutions of a family of polynomial systems given by a parameterisation.
      </p>

    </div> 
    <div id="kube-component" class="content">
    
<nav id="contents">
    <ol class="js-toc">
    </ol>
</nav>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded",
function(){
tocbot.init({

tocSelector: '.js-toc',

contentSelector: '.content',

headingSelector: 'h3'
})
}
);
</script>



    <h3 class="section-head" id="parameter*homotopies"><a href="#parameter*homotopies">Parameter Homotopies</a></h3>

<p>Consider the situation in which one has to solve a specific instance of a <em>parametrized family of polynomial systems</em></p>

<p>$$
P = \{f(x_1,\ldots,x_n,a) = (f_1(x_1,\ldots,x_n,a), \ldots, f_n(x_1\ldots,x_n,a)) \mid a \in \mathbb{R}^m\}.
$$</p>

<p>Often, there is a number $N$, such that a generic member $f\in P$ has exactly $N$ solutions $x\in\mathbb{R}^n$ with $f(x)=0$. This $N$ might be very considerably smaller than the number of solutions of an arbitrary polynomial system not in $P$. To not destroy the solution structure it is desirable to not leave $P$ during the homotopy.</p>

<p>The basic <code>solve</code> of HomotopyContinuation.jl constructs a straight-line homotopy between the start system $g$ and the target system $f$; i.e. $H(x,t)  = tg + (1-t)f$. When $P$ is not convex, $H(x,t)$ might leave the family $P$. For this reason, we implemented <em>parametrized homotopies</em> into HomotopyContinuation.jl. The next example explains its usage.</p>

<p><h3 class="section-head" id="ellipses"><a href="#ellipses">Example: When are two ellipses tangent?</a></h3> The following example is inspired by topological data analysis: suppose that you have a point sample from a manifold $M\subset \mathbb{R}^n$. An approach to estimate topological features of $M$ from the sample is by <a href="https://en.wikipedia.org/wiki/Persistent_homology">persistent homology</a>. The idea is as follows. Around each point one puts a ball of radius $r$. Then one computes the <a href="https://en.wikipedia.org/wiki/Čech_complex">Čech complex</a> of the union of those balls. <a href="https://arxiv.org/pdf/1802.09436.pdf">It was argued</a> that it could be beneficial to replace balls by <em>ellipses</em>. The obstacle in this approach is to compute when two growing ellipses first meet. This problem can be solved by using homotopy continuation.</p>

<p>In dimension 2 the computational problem is as follows. Let the two ellipses be centered at $p_1,p_2$, respectively, and be given by two symmetric matrices $Q_1, Q_2$:</p>

<p>$$
E_i( r ) = \{x\in \mathbb{R}^2 \mid (x-p_i)^T Q_i^TQ_i(x-p_i) = r^2\},\; i=1,2.
$$</p>

<p>We wish to find the smallest radius $r$ for which $E_1( r )\cap E_2( r )$ is not empty. Let $r^\star$ be the solution for this optimization problem. For a generic choice of $Q_1$ and $Q_2$ we have that $\vert E_1(r^\star)\cap E_2(r^\star) \vert =1$ and $E_1(r^\star)$, $E_2(r^\star)$ are tangent. In Julia we translate this into a polynomial system:</p>

<pre><code class="language-julia">using HomotopyContinuation, LinearAlgebra
# generate the variables
@polyvar Q₁[1:2, 1:2] Q₂[1:2, 1:2] p₁[1:2] p₂[1:2]
@polyvar x[1:2] r
z₁ = x - p₁
z₂ = x - p₂
# initialize the equations for E₁ and E₂
f₁ = (Q₁ * z₁) ⋅ (Q₁ * z₁) - r^2
f₂ = (Q₂ * z₂) ⋅ (Q₂ * z₂) - r^2
# initialize the equation for E₁ and E₂ being tangent
@polyvar λ
g = (Q₁' * Q₁) * z₁ - λ .* (Q₂' * Q₂) * z₂
# gather everything in one system
F = [f₁; f₂; g];
</code></pre>

<p>An initial solution is given by two circles, each of radius 1,  centered at $(1,0)$ and $(-1,0)$, respectively.</p>

<pre><code class="language-julia">map(F) do f
    f(vec(Q₁) =&gt; [1,0,0,1], vec(Q₂) =&gt; [1,0,0,1], x =&gt; [0,0], p₁ =&gt; [1,0], p₂ =&gt; [-1,0], λ =&gt; -1, r =&gt; 1)
end
</code></pre>

<pre><code>4-element Array{Int64,1}:
 0
 0
 0
 0
</code></pre>

<p>Let us track this solution to the system given by $p_1 = [7,5], p_2 = [1,2], Q_1 = \begin{pmatrix} 1 &amp; 2 \\ 2 &amp; 4 \end{pmatrix}, Q_2 = \begin{pmatrix} 0 &amp; 3 \\ 3 &amp; 1 \end{pmatrix}$.</p>

<p>That is, the <em>parameters</em> are $p_1, p_2, Q_1, Q_2$ and the <em>variables</em> are $x,r,λ$. Now we track the starting solution towards the target system</p>

<pre><code class="language-julia">params = [vec(Q₁); vec(Q₂); p₁; p₂]
startparams = [1, 0, 0, 1, 1, 0, 0, 1, 1, 0, -1, 0]
targetparams = [vec([1 2; 2 5]); vec([0 3; 3 1]); [7, 5]; [1, 2]]
S = solve(F, [[0, 0, 1, -1]], parameters=params, startparameters=startparams, targetparameters=targetparams)
</code></pre>

<pre><code>AffineResult with 1 tracked paths
==================================
• 1 non-singular finite solution (1 real)
• 0 singular finite solutions (0 real)
• 0 solutions at infinity
• 0 failed paths
• random seed: 387965
</code></pre>

<p>The computation reveals that $r^\star \approx 10.89$. We can plot the two ellipses:</p>

<pre><code class="language-julia">r = solution(S[1])[3]
r = real(r)
E₁ = [r .* (inv([1 2; 2 5]) * [cos(2π*t); sin(2π*t)]) + [7; 5] for t in 0:0.01:1]
E₂ = [r .* (inv([0 3; 3 1]) * [cos(2π*t); sin(2π*t)]) + [1; 2] for t in 0:0.01:1]

# convert E₁, E₂ into matrices
E₁, E₂ = hcat(E₁...), hcat(E₂...)

# Plot. The Plots package must be installed for this
using Plots
plot(E₁[1,:], E₁[2,:], label=&quot;Ellipse 1&quot;)
plot!(E₂[1,:], E₂[2,:], label=&quot;Ellipse 2&quot;)
</code></pre>

<p>This gives the following picture.</p>

<p><img src="/images/ellipse.png" alt="img" /></p>



    
    </div>
    </div>
</main>
  <footer></footer>


  <script src="/js/kube.js" type="text/javascript">
  </script>
  <script src="/js/kube.legenda.js" type="text/javascript">
  </script>
  <script src="/js/master.js" type="text/javascript">
  </script>
  <script type="text/javascript">
     document.addEventListener("DOMContentLoaded", function() {
           renderMathInElement(document.body, {delimiters: [
          {left: "$$", right: "$$", display: true},
          {left: "$", right: "$", display: false},
          {left: "``", right: "``", display: false},
          
          
          
        ]});
      });</script>
</body>

</html>
