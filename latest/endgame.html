<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Endgame · Julia Homotopy Continuation</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="index.html"><img class="logo" src="assets/logo.png" alt="Julia Homotopy Continuation logo"/></a><h1>Julia Homotopy Continuation</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">Introduction</a></li><li><a class="toctext" href="examples.html">Examples</a></li><li><a class="toctext" href="Homotopy.html">Setting up homotopies</a></li><li><a class="toctext" href="solve.html">Solving homotopies</a></li><li><a class="toctext" href="pathtracker.html">Pathtracking</a></li><li class="current"><a class="toctext" href="endgame.html">Endgame</a><ul class="internal"><li><a class="toctext" href="#Examples-1">Examples</a></li><li><a class="toctext" href="#Result-1">Result</a></li><li><a class="toctext" href="#Algorithms-1">Algorithms</a></li><li><a class="toctext" href="#Reference-1">Reference</a></li></ul></li><li><a class="toctext" href="set_up_homotopy.html">How to set up your own homotopy</a></li><li><a class="toctext" href="set_up_pathtracker.html">How to set up your own pathtracking algorithm</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="endgame.html">Endgame</a></li></ul><a class="edit-page" href="https://github.com/JuliaHomotopyContinuation/juliahomotopycontinuation.github.io/blob/source/docs/src/endgame.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Endgame</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Endgame-1" href="#Endgame-1">Endgame</a></h1><p>Assume we want to find the all solutions of the polynomial <span>$(x-2)^4$</span> with homotopy continuation. Then the pathtracker gets into severe trouble near the end of the path since the derivative is <span>$0$</span> at <span>$x=2$</span>.</p><p>How do we solve that problem? The idea is to split the pathtracking into two parts. We first track the path <code>x(t)</code> until the so called <em>endgame zone</em> (starting by default at <span>$t=0.1$</span>). Then we switch to the <em>endgame</em>. The idea is to estimate the value of <code>x(0.0)</code> without tracking the path all the way to <span>$t=0.0$</span>(since this would fail due to a singular Jacobian).</p><p>There are two well known endgame strategies. The <em>Power Series Endgame</em> and the <em>Cauchy Endgame</em>. Currently only the <em>Cauchy Endgame</em> is implemented.</p><p>At the heart of the endgame routine is the  <code>mutable struct</code> <code>Endgamer</code>.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.Endgamer" href="#HomotopyContinuation.Endgamer"><code>HomotopyContinuation.Endgamer</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">Endgamer(endgame_algorithm, pathtracker, [x, R]; kwargs...)</code></pre><p>Construct an Endgamer object. The Endgamer &#39;plays&#39; the endgame with the given <code>endgame_algorithm</code> and uses the given <code>pathtracker</code> to move forward. The endgame is start at <code>x</code> to time <code>R</code> (the endgame radius). In each iteration the endgame moves forward and then performs one iteration of the endgame algorithm. In each iteration we could get another prediction and an estimate of the winding number. Convergence is declared if two consecutive predictions are smaller than a defined tolerance (<code>endgame_abstol</code>).</p><p>The following options are available:</p><ul><li><p><code>geometric_series_factor=0.5</code>: The Endgamer moves forward using the geometric series   <span>$λ^kR$</span> where <span>$λ$</span> is <code>geometric_series_factor</code>.</p></li><li><p><code>max_winding_number=16</code> the maximal winding number we allow. If we get a higher winding number</p></li></ul><p>the path is declared failed.</p><ul><li><p><code>endgame_abstol=pathtracker.options.abstol</code>: The tolerance necessary to declare convergence.</p></li></ul><p>Endgamer supports similar to <a href="pathtracker.html#HomotopyContinuation.Pathtracker"><code>Pathtracker</code></a> an iterator interface.</p></div><a class="source-link" target="_blank" href="https://github.com/JuliaHomotopyContinuation/HomotopyContinuation.jl/blob/31f1130ee9ed5920839dc40b3282c736073f30df/src/endgamer/type.jl#L11-L29">source</a></section><h2><a class="nav-anchor" id="Examples-1" href="#Examples-1">Examples</a></h2><p>The follwing example demonstrates the usual workflow. You first create an <code>Endgamer</code> object, then you can track a path from a given start value and finally you create a <code>EndgamerResult</code>.</p><pre><code class="language-julia">endgamer = Endgamer(CauchyEndgame(), pathtracker)
endgamer!(endgamer, x, 0.1)
result = EndgamerResult(endgamer)</code></pre><p>You can reuse (and should!) resuse an <code>Endgamer</code> for multiple paths</p><pre><code class="language-julia">endgamer = Endgamer(CauchyEndgame(), pathtracker))
results = map(xs) do x
  endgame!(endgamer, x, 0.1)
  EndgamerResult(endgamer)
end</code></pre><h2><a class="nav-anchor" id="Result-1" href="#Result-1">Result</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.EndgamerResult" href="#HomotopyContinuation.EndgamerResult"><code>HomotopyContinuation.EndgamerResult</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">EndgamerResult(endgamer, extended_analysis=false)</code></pre><p>Reads the result from the current pathtracker state. A <code>EndgamerResult</code> contains:</p><ul><li><p><code>returncode</code>: One of <code>:ill_conditioned_zone</code>, <code>:success</code>, <code>:windingnumber_too_high</code></p></li><li><p><code>solution::Vector{T}</code>: The solution.</p></li><li><p><code>startvalue::Vector{T}</code>: The solution.</p></li><li><p><code>residual::Float64</code>: The value of the infinity norm of <code>H(solution, 0)</code>.</p></li><li><p><code>iterations</code>: The number of iterations the pathtracker needed.</p></li><li><p><code>npredictions</code>: The number of predictions</p></li><li><p><code>predictions</code>: All predictions for further introspection (e.g. the path failed)</p></li><li><p><code>angle_to_infinity</code>: The angle to infinity is the angle of the solution to the hyperplane where the homogenizing coordinate is <span>$0$</span>.</p></li><li><p><code>windingnumber</code>: The estimated winding number</p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/JuliaHomotopyContinuation/HomotopyContinuation.jl/blob/31f1130ee9ed5920839dc40b3282c736073f30df/src/endgamer/result.jl#L3-L17">source</a></section><h2><a class="nav-anchor" id="Algorithms-1" href="#Algorithms-1">Algorithms</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.CauchyEndgame" href="#HomotopyContinuation.CauchyEndgame"><code>HomotopyContinuation.CauchyEndgame</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">CauchyEndgame(;kwargs...)</code></pre><p>The main idea of the Cauchy Endgame is to use <a href="https://en.wikipedia.org/wiki/Cauchy%27s_integral_formula">Cauchy&#39;s integral formula</a> to predict the solution of the path <span>$x(t)$</span>, i.e. <span>$x(0)$</span>. At each iteration we are at some point <span>$(x, t)$</span>. We then track the polygon defined by <span>$te^{i2πk/n}$</span> until we end again at <span>$x$</span>. Here <span>$n$</span> is the number of samples we take per loop.</p><p>The following options are available:</p><ul><li><p><code>samples_per_loop=8</code>: The number of samples we take at one loop.</p></li><li><p><code>loopclosed_tolerance=1e-5</code>: The tolerance when a loop is considered closed.</p></li><li><p><code>L=0.75</code> and <span>$K=0.5$</span>: These are paramters for heuristics. For more details see &quot;A Parallel Endgame &quot; by Bates, Hauenstein and Sommese <a href="#footnote-1">[1]</a>,   page 8 and 9.</p></li></ul><div class="footnote" id="footnote-1"><a href="#footnote-1"><strong>[1]</strong></a><p>Bates, Daniel J., Jonathan D. Hauenstein, and Andrew J. Sommese. &quot;A Parallel Endgame.&quot; Contemp. Math 556 (2011): 25-35.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaHomotopyContinuation/HomotopyContinuation.jl/blob/31f1130ee9ed5920839dc40b3282c736073f30df/src/endgame_algorithms/cauchy.jl#L3-L19">source</a></section><h2><a class="nav-anchor" id="Reference-1" href="#Reference-1">Reference</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.endgame!" href="#HomotopyContinuation.endgame!"><code>HomotopyContinuation.endgame!</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">endgame!(endgamer, x, R)</code></pre><p>Play the endgame for <code>x</code> starting from time <code>R</code>.</p><pre><code class="language-none">endgame!(endgamer)</code></pre><p>Start the endgamer. You probably want to setup things in prior with <a href="endgame.html#HomotopyContinuation.setup_endgamer!"><code>setup_endgamer!</code></a>.</p></div><a class="source-link" target="_blank" href="https://github.com/JuliaHomotopyContinuation/HomotopyContinuation.jl/blob/31f1130ee9ed5920839dc40b3282c736073f30df/src/endgamer/iterator_interface.jl#L3-L11">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.setup_endgamer!" href="#HomotopyContinuation.setup_endgamer!"><code>HomotopyContinuation.setup_endgamer!</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">setup_endgamer!(endgamer, x, R)</code></pre><p>Setup <code>endgamer</code> to play the endgame starting from <code>x</code> at time <code>R</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/JuliaHomotopyContinuation/HomotopyContinuation.jl/blob/31f1130ee9ed5920839dc40b3282c736073f30df/src/endgamer/modify.jl#L4-L8">source</a></section><footer><hr/><a class="previous" href="pathtracker.html"><span class="direction">Previous</span><span class="title">Pathtracking</span></a><a class="next" href="set_up_homotopy.html"><span class="direction">Next</span><span class="title">How to set up your own homotopy</span></a></footer></article></body></html>
